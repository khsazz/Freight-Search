<!DOCTYPE html>

<html lang="en"> 
<!-- BEGIN HEAD-->
<head>

 <meta charset="UTF-8" />
 <title>Freight Search</title>
 <meta content="width=device-width, initial-scale=1.0" name="viewport" />
 <meta content="" name="description" />
 <meta content="" name="author" />
     <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
        <!-- GLOBAL STYLES -->
        <!-- GLOBAL STYLES -->
        <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.css" />
        <link rel="stylesheet" type="text/css" href="assets/css/custom.css">
        <link rel="stylesheet" href="assets/css/main.css" />
        <link rel="stylesheet" href="assets/css/theme.css" />
        <link rel="stylesheet" href="assets/css/MoneAdmin.css" />
        <link rel="stylesheet" href="assets/plugins/Font-Awesome/css/font-awesome.css" />
        <!--END GLOBAL STYLES -->

        <!-- PAGE LEVEL STYLES -->
        <link href="assets/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">
        <!-- END PAGE LEVEL  STYLES -->
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.2/react.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.2/react-dom.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
        <script src="path.js"></script>

    </head>
    <!-- END  HEAD-->

    <!-- ----------------------------------------------- -->
    <!-- ----------------------------------------------- -->

    <!-- BEGIN BODY-->
    <body class="padTop53 " >

     <!-- MAIN WRAPPER -->
     <div id="wrap" style="background-color: #FFFFFF;">


         <!-- HEADER SECTION -->
         <div id="top">

            <nav class="navbar navbar-inverse navbar-fixed-top " style="padding-top: 10px; background-color: #4187C3">
                <a data-original-title="Show/Hide Menu" data-placement="bottom" data-tooltip="tooltip" class="accordion-toggle btn btn-primary btn-sm visible-xs" data-toggle="collapse" href="#menu" id="menu-toggle">
                    <i class="icon-align-justify"></i>
                </a>
                <!-- LOGO SECTION -->
                <header class="navbar-header">

                    <a href="#" class="navbar-brand">
                        <img src="soft.png" height="40" width="140" alt="" />
                    </a>
                </header>
                <!-- END LOGO SECTION -->
                
            </nav>
        </div>
        <!-- END HEADER SECTION -->

        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!--PAGE CONTENT -->

        <!-- nav menu -->
        <div class="row" align="center">
            <div class="col-lg-4"></div>
            <div class="col-lg-7">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#">SOLUTIONS</a></li>
                    <li><a href="#">HOW TO OPTIMIZE</a></li>
                    <li><a href="#">REFERENCES</a></li>
                    <li><a href="#">ABOUT US</a></li>
                    <li><a href="#">SUPPORT</a></li>
                    <li><a href="#">SIGN UP</a></li>
                </ul>
            </div>
            <div class="col-lg-1"></div>            
        </div>

        <!-- nav menu end-->

        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!-- image row -->
        <div class="row">
            <div class="col-lg-2"></div>
            <div class="col-lg-8 col-sm-4">
                <div class="row" align="center">
                    <img src="truck.jpg" height="120" width="900" alt="" />
                    
                </div>
            </div>
            <div class="col-lg-2"></div>    
        </div>
        
        <!-- image row end -->
        
        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!-- button row -->
        <div class="row" style="margin-top: 5px;margin-bottom:15px;">
        <br>
            <div class="col-lg-2"></div>
            <div class="col-lg-2">
                <button type="button" class="btn btn-primary">Dashboard</button> 
            </div>
            <div class="col-lg-2">
                <button type="button" class="btn btn-primary">Freight Search</button> 
            </div>
            <div class="col-lg-2">
                <button type="button" class="btn btn-primary">Spot Request</button> 
            </div>
            <div class="col-lg-2">
                <button type="button" class="btn btn-primary">Bookings</button> 
            </div>
            <div class="col-lg-2"></div>
        </div>
        <!-- button row end-->

        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!-- search field row -->
        <div class="row">
            <div class="col-lg-2"></div>
            <div class="col-lg-8">
                <form class="form-inline" role="form" onsubmit="Search_function()">
                    <div class="col-lg-3">
                        <div class="row">
                            <div class="form-group">
                                <label for="from">From</label>
                                <input class="form-control" id="from" type="text">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 20px;">
                            <div class="form-group">
                                <label for="from">Unit</label>
                                <input class="form-control" id="unit" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-1"></div>
                    <div class="col-lg-3">
                        <div class="row" align="left">
                            <div class="form-group">
                                <label for="to"> To  </label>
                                <input class="form-control" id="to" type="text">
                            </div>
                        </div>
                        <div class="row" align="left" style="margin-top: 20px;">
                            <div class="form-group">
                                <label for="to"> Terms  </label>
                                <input class="form-control" id="terms" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-1"></div>
                    <div class="col-lg-4" style="margin-top: 55px;">
                        <button id="myButton1" type="submit" class="btn btn-primary">Search</button>
                    </div>
                </form>    
            </div>
            
            <div class="col-lg-2"></div>
        </div>
        <!-- search field row end-->

        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!-- Map -->
        <div class="row" align="center" style="margin-top: 50px;">
            <div class="hidden" id="map-container" style="height: 400px; width: 800px;"></div>
 
        
        </div>
        
        <!-- Map end -->

        <!-- ----------------------------------------------- -->
        <!-- ----------------------------------------------- -->

        <!-- Search Result List -->

    <div class="container">
        <div class="row hidden" id="hidden1" align="left" style="margin-top: 20px;">
            <div class="col-lg-1"></div>
            <div class="col-lg-10">

                <!-- <div id="everything"> -->
                    <div id="tbl_display2">
                </div>    
                <!-- </div> -->
                

            </div>

            <div class="col-lg-1"></div>

        </div>
    </div>
    <!-- Search Result List END-->

        <!--END PAGE CONTENT -->
    </div>
    <!--END MAIN WRAPPER -->

    <!-- ----------------------------------------------- -->
    <!-- ----------------------------------------------- -->

    <!-- FOOTER -->
    <div id="footer">
        <p>&copy;  Khsazz &nbsp;2015 &nbsp;</p>
    </div>
    <!--END FOOTER -->

    <!-- ----------------------------------------------- -->
    <!-- ----------------------------------------------- -->

    <!-- GLOBAL SCRIPTS -->
    <script src="assets/plugins/jquery-2.0.3.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/plugins/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js"></script>
        
    <!-- END GLOBAL SCRIPTS -->
    
    <!-- PAGE LEVEL SCRIPTS -->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOUuK_T-LnuSRp0tl5vRYD26RftQEekg4&signed_in=false&callback=initMap"></script>

    <script>    
          function initMap(mapRoutes) {
              var map = new google.maps.Map(document.getElementById('map-container'), {
                zoom: 3,
                center: {lat: 45, lng: 0},
                mapTypeId: google.maps.MapTypeId.TERRAIN
              });

              var myLatLng = new google.maps.LatLng(37.772,-122.214);
              var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';

                var marker = new google.maps.Marker({
                  position: myLatLng,
                  map: map,
                  icon: iconBase + 'truck_maps.png'
                });
                marker.setMap(map);

            var flightPlanCoordinates;
            var allFlightPlans = new Array();

            function flightPlanCoordinate(lat, lng){
                this.lat = lat;
                this.lng = lng;
            }

            for(var i=0; i<mapRoutes.length; i++){
                var flightPlanCoordinates = new Array();
                for(var j=0; j<mapRoutes[i].length; j++){
                    var place = mapRoutes[i][j];
                    var coordinate = new flightPlanCoordinate(places[place].lattitude, places[place].longitude);
                    flightPlanCoordinates.push(coordinate);
                }
                allFlightPlans.push(flightPlanCoordinates);
            }

              // var flightPlanCoordinates1 = [
              //   {lat: 37.772, lng: -122.214},
              //   {lat: 21.291, lng: -157.821},
              //   {lat: -18.142, lng: 178.431},
              //   {lat: -27.467, lng: 153.027}
              // ];

              // var flightPlanCoordinates2 = [
              //   {lat: 37.772, lng: -132.214},
              //   {lat: 21.291, lng: -187.821}
              // ];

              var colors = [ "blue", "black", "white", "red", "green" ];

              function makeFlightPath(flightPlanCoordinates, stroke){
                var flightPath = new google.maps.Polyline({
                path: flightPlanCoordinates,
                geodesic: true,
                strokeColor: stroke,
                strokeOpacity: 1.0,
                strokeWeight: 4
                });   
                flightPath.setMap(map);             
              }

              for(var i=0; i<allFlightPlans.length; i++){
                makeFlightPath(allFlightPlans[i], colors[i]);
              }
              // var flightPath1 = new google.maps.Polyline({
              //   path: flightPlanCoordinates1,
              //   geodesic: true,
              //   strokeColor: '#FF0000',
              //   strokeOpacity: 1.0,
              //   strokeWeight: 2
              // });

              // var flightPath2 = new google.maps.Polyline({
              //   path: flightPlanCoordinates2,
              //   geodesic: true,
              //   strokeColor: '#FF0F00',
              //   strokeOpacity: 1.0,
              //   strokeWeight: 3
              // });

              // flightPath1.setMap(map);
              // flightPath2.setMap(map);
        }
     
        </script>
        <script type="text/javascript">
                    var firstTime = true;
                    var from="STO", to="ORL";
                    // var paths = findPath( from, to); 
                    var paths;
                    var mapRoutes;
                    function Search_function(){
                        if(firstTime){
                            event.preventDefault();
                            firstTime = false;    
                        }

                        
                        from = document.forms[0].from.value;
                        to = document.forms[0].to.value;
                        paths = findPath( from, to); 
                        if(!paths){
                            return;
                        }
                        mapRoutes = getMapRoutes();
                        // StartRendering();
                        // ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));
                        $("#hidden1").removeClass('hidden');
                        // SearchRoute();
                        $("#map-container").removeClass('hidden');
                        initMap(mapRoutes);
                        // alert(from+" - "+to);
                        // addElemnt();
                    };

                    // function addElemnt(){
                    // $("#everything").remove();
                    //     $("#everything").append(
                    //         '<div id="tbl_display2"></div>'
                    //     );
                    // }
        </script>
        
        <script type="text/babel">
                    
                    
                    // var From = "STO";
                    // var To = "ORL";
                    
                    

                    var Panel_heading = React.createClass({
                        render: function () {
                            return (
                                    < div className = "panel-heading" >
                                    < h4 > Option1 CIF < / h4 >
                            < h4 > {this.props.data} FROM {this.props.cost} Euro AND {this.props.time} Days < / h4 >
                            < / div >
                            )
                            ;
                        }
                    });

                    var Panel_footer = React.createClass({
                        render: function () {
                            return (
                                    < div
                            className = "panel-footer" >
                                    < p
                            className = "text-right" > < span
                            className = "label label-info" > 
                            Total {this.props.text} Euro < / span > < / p >
                            < / div >
                            )
                            ;
                        }
                    });

                    var List_item = React.createClass({

                        
                        render: function () {
                            var PlaceA = getPlacebyID(this.props.data.sourcePlaceID);
                            var PlaceB = getPlacebyID(this.props.data.destPlaceID);
                            return (
                                    < li className = "list-group-item" >
                                    < p > {this.props.data.time} Day < / p > < p > {PlaceA.placeCode} - {PlaceB.placeCode} < / p > < p > {this.props.data.description} < / p >
                                    < p className = "text-right" > {this.props.data.cost} Euro < / p >
                                    < / li >
                            );
                        }
                    });

                    var Panel_Body = React.createClass({

                        
                        render: function () {
                            var Item =this.props.data.map(function(list){
                                return(<List_item key={list.destPlaceID} data={list}></List_item>);
                            }); 


                            return (
                                    < div className = "panel-body" >
                                    < ul className = "list-group" >
                                        {Item}
                                    < / ul >
                                    < / div >
                            )
                            ;
                        }
                    });

                    var Start = React.createClass({

                        render: function () {

                            var TotalCost = 0; var TotalTime = 0; var HeadLine = getPlacebyID(this.props.data[0].sourcePlaceID).placeCode;
                            var CostFunction = this.props.data.map(function(list){
                                TotalCost = TotalCost + list.cost;
                                TotalTime = TotalTime + list.time;
                                HeadLine = HeadLine + " - "+ getPlacebyID(list.destPlaceID).placeCode;
                            }); 

                            return (

                                                < div className = "panel panel-primary" >
                                                < Panel_heading data={HeadLine} cost={TotalCost} time={TotalTime} / >
                                                < Panel_Body data= {this.props.data}/ >
                                                < Panel_footer text={TotalCost} / >
                                                < / div >
                                        )

                        }
                    });


                    var Nodes = React.createClass({

                        getInitialState: function() {
                            return {data: []};
                          },


                        render : function(){
                            var z=1;
                            var c= this.props.data.map(function(i){
                                return (<Start key={z++} data= {i} />);
                            });
                            return(
                                <div >{c}</div>
                                );
                            }
                        });
                    
                    // ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));
                    
                    // if(paths !== false){
                    //     ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));    
                    // }
                    // else{
                    //     alert("No rendering");
                    // }

                    setInterval(function() {
                          ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));
                        }, 500);

                    // function StartRendering(){
                    //     ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));    
                    // };

                    // var StartRendering = function(){
                    //     ReactDOM.render(<Nodes data={paths}/> , document.getElementById('tbl_display2'));    
                    // }
        
        </script>    

            

    <!-- END PAGE LEVEL SCRIPTS -->

    <!-- ----------------------------------------------- -->
    <!-- ----------------------------------------------- -->


</body>
<!-- END BODY-->

</html>
